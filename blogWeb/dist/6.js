(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{306:function(t,e,n){"use strict";var i=n(1),o=n.n(i)()((function(t){return t[1]}));o.push([t.i,"[data-v-2eb89864] .time{font-size:12px;margin-right:20px;color:#99a2aa}",""]),e.a=o},307:function(t,e,n){"use strict";var i=n(1),o=n.n(i)()((function(t){return t[1]}));o.push([t.i,".container[data-v-b731d898]{display:flex;align-items:center}.container .el-avatar[data-v-b731d898]{margin-right:5px}",""]),e.a=o},308:function(t,e,n){"use strict";var i=n(1),o=n.n(i),a=n(32),r=o()((function(t){return t[1]}));r.i(a.a),r.push([t.i,"#content[data-v-1dafa516]{padding:20px}#info[data-v-1dafa516]{display:flex;align-items:center;font-size:.7rem;color:#757575}#info>*[data-v-1dafa516]{margin-right:20px}#info .follow[data-v-1dafa516]{width:80px;margin-left:0}",""]),e.a=r},516:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-page-header",{attrs:{content:"文章详情"},on:{back:t.exit}}),t._v(" "),t.article?n("div",[n("h3",[t._v(t._s(t.article.title))]),t._v(" "),n("el-container",{attrs:{id:"info"}},[n("AvatarName",{attrs:{avatar:t.article.avatar,name:t.article.author,userKey:t.article.key}}),t._v(" "),t._l(t.article.type,(function(e,i){return n("el-button",{key:i,attrs:{type:"text"},on:{click:function(n){return t.goSquare(e)}}},[t._v(t._s(t.type(e)))])})),t._v(" "),n("span",[t._v(t._s(t._f("transtime")(t.article.time)))]),t._v(" "),n("span",[t._v(t._s(t.article.views)+"阅读")]),t._v(" "),t.interaction.isFollow?n("el-button",{staticClass:"follow",attrs:{type:"success",size:"mini"},on:{click:t.unFollow}},[n("i",{staticClass:"el-icon-check"}),t._v("\n        已关注\n      ")]):n("el-button",{staticClass:"follow",attrs:{size:"mini",type:"danger"},on:{click:t.follow}},[n("i",{staticClass:"el-icon-plus"}),t._v("\n        关注\n      ")])],2),t._v(" "),n("div",{attrs:{id:"content"},domProps:{innerHTML:t._s(t.article.content)}}),t._v(" "),t.interaction.isLike?n("el-button",{attrs:{type:"text",title:"点赞"},on:{click:t.unLike}},[n("i",{staticClass:"iconfont icon-zan"}),t._v(t._s(t.article.likes))]):n("el-button",{attrs:{type:"text",title:"点赞"},on:{click:t.like}},[n("i",{staticClass:"iconfont icon-zan1"}),t._v(t._s(t.article.likes))]),t._v(" "),t.interaction.isCollection?n("el-button",{attrs:{type:"text",title:"收藏"},on:{click:t.unCollection}},[n("i",{staticClass:"iconfont icon-shoucang"},[t._v(t._s(t.article.collections))])]):n("el-button",{attrs:{type:"text",title:"收藏"},on:{click:t.collection}},[n("i",{staticClass:"iconfont icon-shoucang1"}),t._v(t._s(t.article.collections))]),t._v(" "),n("el-button",{attrs:{type:"text",title:"分享"}},[n("i",{staticClass:"iconfont icon-fenxiang"}),t._v(t._s(t.article.shares))]),t._v(" "),n("el-divider"),t._v(" "),n("Comment")],1):n("Empty",{attrs:{text:"文章不存在或已被删除"}})],1)};i._withStripped=!0;var o=n(47),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-row",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:2}},[n("el-avatar",{attrs:{src:t.avatar}})],1),t._v(" "),n("el-col",{attrs:{span:18}},[n("el-form",{ref:"commentForm",attrs:{model:t.commentForm}},[n("el-form-item",{attrs:{prop:"content",rules:t.rules}},[n("el-input",{attrs:{type:"textarea",rows:4,resize:"none",placeholder:"来一发友善的评论吧"},model:{value:t.commentForm.content,callback:function(e){t.$set(t.commentForm,"content",e)},expression:"commentForm.content"}})],1)],1)],1),t._v(" "),n("el-col",{attrs:{span:4}},[n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(e){return t.uploadComment()}}},[t._v("发表")])],1)],1),t._v(" "),n("el-row",[n("el-divider")],1),t._v(" "),n("el-row",{directives:[{name:"show",rawName:"v-show",value:t.replyForm.visible,expression:"replyForm.visible"}],attrs:{gutter:20,id:"reply-form1"}},[n("el-col",{attrs:{span:2}},[n("el-avatar",{attrs:{src:t.avatar}})],1),t._v(" "),n("el-col",{attrs:{span:18}},[n("el-form",{ref:"replyForm",attrs:{model:t.replyForm}},[n("el-form-item",{attrs:{prop:"content",rules:t.rules}},[n("el-input",{attrs:{type:"textarea",rows:4,resize:"none",placeholder:t.replyForm.placeholder},model:{value:t.replyForm.content,callback:function(e){t.$set(t.replyForm,"content",e)},expression:"replyForm.content"}})],1)],1)],1),t._v(" "),n("el-col",{attrs:{span:4}},[n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.uploadReply}},[t._v("发表")])],1)],1),t._v(" "),t._l(t.comments,(function(e,i){return n("el-row",{key:e.comment_id,attrs:{gutter:20}},[n("el-col",{attrs:{span:2}},[n("el-avatar",{attrs:{src:e.from.avatar}})],1),t._v(" "),n("el-col",{attrs:{span:22}},[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.zone(e.from.key)}}},[t._v(t._s(e.from.name))]),t._v(" "),n("el-row",[t._v(t._s(e.content))]),t._v(" "),n("el-row",[n("span",{staticClass:"time"},[t._v(t._s(t._f("transtime")(e.time)))]),t._v(" "),n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return t.openReply(e,i)}}},[t._v("回复")]),t._v(" "),n("Reply",{attrs:{comment_id:e.comment_id,article_id:e.article_id,index:i,reply:e.reply},on:{openReply:t.openReply,zone:t.zone}})],1),t._v(" "),n("el-row",[n("el-divider")],1)],1)],1)})),t._v(" "),n("el-pagination",{attrs:{layout:"total, prev, pager, next",total:t.commentTotal,"page-size":t.commentPageSize},on:{"current-change":t.getArticleComment}})],2)};a._withStripped=!0;n(252),n(251);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.replyList.length?n("div",[t._l(t.replyList,(function(e,i){return n("el-row",{key:i,attrs:{gutter:20}},[n("el-col",{attrs:{span:2}},[n("el-avatar",{attrs:{src:e.from.avatar}})],1),t._v(" "),n("el-col",{attrs:{span:22}},[n("el-row",[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.zone(e.from.key)}}},[t._v(t._s(e.from.name))]),t._v(" "),e.to.key!==e.from.key?n("span",{staticStyle:{"font-size":"12px",margin:"0 5px"}},[t._v("回复 "),n("el-button",{attrs:{type:"text"},on:{click:e.to.key}},[t._v(t._s(e.to.name))])],1):t._e(),t._v(" "),n("span",[t._v("："+t._s(e.content))])],1),t._v(" "),n("el-row",[n("span",{staticClass:"time"},[t._v(t._s(t._f("transtime")(e.time)))]),t._v(" "),n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return t.openReply(e)}}},[t._v("回复")])],1)],1)],1)})),t._v(" "),n("el-pagination",{attrs:{layout:"total, prev, pager, next",total:t.replyTotal,"page-size":t.replyPageSize},on:{"current-change":t.getCommentReply}})],2):t._e()};r._withStripped=!0;var s=n(253),l={mixins:[s.a],props:["comment_id","article_id","index","reply"],data:function(){return{replyTotal:0,replyPageSize:5,replyList:[]}},methods:{getCommentReply:function(t){var e=this,n={article_id:this.article_id,comment_id:this.comment_id,pageSize:this.replyPageSize,page:t};o.a.getCommentReply(n).then((function(t){var n=t.data;console.log(n),n.status&&(e.replyList=n.data.replys,e.replyTotal=n.data.total)}))},zone:function(t){this.$router.push({name:"zone",query:{key:t}})},openReply:function(t){this.$emit("openReply",t,this.index)}},watch:{reply:function(t){t&&this.replyList.unshift(t)}},mounted:function(){this.getCommentReply(1)}},c=n(4),m=Object(c.a)(l,r,[],!1,null,"52594499",null);m.options.__file="src/pages/user/components/articleDetail/Reply.vue";var u,p=m.exports,d=new Uint8Array(16);function v(){if(!u&&!(u="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return u(d)}var f=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var y=function(t){return"string"==typeof t&&f.test(t)},_=[],h=0;h<256;++h)_.push((h+256).toString(16).substr(1));var g=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(_[t[e+0]]+_[t[e+1]]+_[t[e+2]]+_[t[e+3]]+"-"+_[t[e+4]]+_[t[e+5]]+"-"+_[t[e+6]]+_[t[e+7]]+"-"+_[t[e+8]]+_[t[e+9]]+"-"+_[t[e+10]]+_[t[e+11]]+_[t[e+12]]+_[t[e+13]]+_[t[e+14]]+_[t[e+15]]).toLowerCase();if(!y(n))throw TypeError("Stringified UUID is invalid");return n};var k=function(t,e,n){var i=(t=t||{}).random||(t.rng||v)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(var o=0;o<16;++o)e[n+o]=i[o];return e}return g(i)},w={mixins:[s.a],data:function(){return{article_id:this.$route.query.article_id||"",comments:"",rules:{required:!0,message:"内容不能为空",trigger:"blur"},commentTotal:0,commentPageSize:10,index:"",replyForm:{el:"",visible:!1,placeholder:"",content:"",to:"",article_id:"",comment_id:""},commentForm:{article_id:this.$route.query.article_id,comment_id:"",content:""}}},methods:{uploadComment:function(){var t=this;this.$refs.commentForm.validate((function(e){t.isLogin()&&e&&(t.commentForm.comment_id=k(),o.a.uploadComment({comment:t.commentForm}).then((function(e){var n=e.data;console.log(n),n.status&&(t.comments.unshift({article_id:t.commentForm.article_id,comment_id:t.commentForm.comment_id,content:t.commentForm.content,time:new Date,from:{avatar:sessionStorage.getItem("avatar"),key:sessionStorage.getItem("key"),name:sessionStorage.getItem("name")}}),t.commentForm.content="",t.$message({type:"success",message:"评论成功"})),console.log(t.comments)})))}))},uploadReply:function(){var t=this;this.isLogin()&&this.$refs.replyForm.validate((function(e){if(e){var n={to:t.replyForm.to,content:t.replyForm.content,comment_id:t.replyForm.comment_id,article_id:t.replyForm.article_id};o.a.uploadReply({reply:n}).then((function(e){var i=e.data;console.log(i),i.status&&(t.replyForm.content="",t.$message({type:"success",message:"回复成功"}),n.to=t.comments[t.index].from,n.from={name:sessionStorage.getItem("name"),key:sessionStorage.getItem("key"),avatar:sessionStorage.getItem("avatar")},n.time=new Date,t.$set(t.comments[t.index],"reply",n),t.replyForm.visible=!1)}))}}))},openReply:function(t,e){this.isLogin()&&(this.index=e,this.replyForm.visible=!0,event.target.parentNode.parentNode.append(this.replyForm.el),this.replyForm.placeholder="回复 "+t.from.name,this.replyForm.comment_id=t.comment_id,this.replyForm.article_id=t.article_id,this.replyForm.to=t.from.key)},getArticleComment:function(t){var e=this,n={article_id:this.article_id,page:t};o.a.getArticleComment(n).then((function(t){var n=t.data;console.log(n),n.status&&(e.comments=n.data.comments,e.commentTotal=n.data.total)}))},zone:function(t){this.$router.push({name:"zone",query:{key:t}})}},components:{Reply:p},computed:{avatar:function(){return sessionStorage.getItem("avatar")||"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}},mounted:function(){this.replyForm.el=document.querySelector("#reply-form1"),this.getArticleComment()}},b=n(2),x=n.n(b),F=n(306),C={insert:"head",singleton:!1},z=(x()(F.a,C),F.a.locals,Object(c.a)(w,a,[],!1,null,"2eb89864",null));z.options.__file="src/pages/user/components/articleDetail/Comment.vue";var S=z.exports,$=n(255),R=function(){var t=this.$createElement,e=this._self._c||t;return e("el-row",{staticClass:"container"},[e("el-avatar",{attrs:{src:this.avatar}}),this._v(" "),e("el-button",{attrs:{type:"text"},on:{click:this.zone}},[this._v(this._s(this.name))])],1)};R._withStripped=!0;var L={props:{avatar:{type:String,default:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"},name:{type:String,default:"未知用户"},userKey:{type:String,default:""}},methods:{zone:function(){this.$router.push({name:"zone",query:{key:this.userKey}})}}},A=n(307),q={insert:"head",singleton:!1},D=(x()(A.a,q),A.a.locals,Object(c.a)(L,R,[],!1,null,"b731d898",null));D.options.__file="src/components/AvatarName.vue";var I=D.exports,E={mixins:[s.a],data:function(){return{article:null,comment:"",types:{front:"前端",back:"后端",js:"JavaScript"},interaction:{isLike:!1,isCollection:!1,isFollow:!1}}},methods:{exit:function(){this.$router.go(-1)},like:function(){var t=this;if(this.isLogin()){var e={article_id:this.article.article_id};o.a.like(e).then((function(e){var n=e.data;console.log(n),n.status&&(t.interaction.isLike=!0,t.article.likes+=1)}))}},unLike:function(){var t=this,e={article_id:this.article.article_id};o.a.unLike(e).then((function(e){var n=e.data;console.log(n),n.status&&(t.interaction.isLike=!1,t.article.likes-=1)}))},collection:function(){var t=this;if(this.isLogin()){var e={article_id:this.article.article_id};o.a.collection(e).then((function(e){var n=e.data;console.log(n),n.status&&(t.interaction.isCollection=!0,t.article.collections+=1)}))}},unCollection:function(){var t=this,e={article_id:this.article.article_id};o.a.unCollection(e).then((function(e){var n=e.data;console.log(n),n.status&&(t.interaction.isCollection=!1,t.article.collections-=1)}))},follow:function(){var t=this;if(this.isLogin()){var e={key:this.article.key};o.a.follow(e).then((function(e){var n=e.data;console.log(n),n.status&&(t.interaction.isFollow=!0)}))}},unFollow:function(){var t=this,e={key:this.article.key};o.a.unFollow(e).then((function(e){var n=e.data;console.log(n),n.status&&(t.interaction.isFollow=!1)}))},zone:function(){this.$router.push({path:"/zone",query:{key:this.article.key}})},getArticleDetail:function(){var t=this,e={article_id:this.$route.query.article_id};o.a.getArticleDetail(e).then((function(e){var n=e.data;console.log(n),n.status&&(t.article=n.data.article)}))},getUserInteractionWithArticle:function(){var t=this,e={article_id:this.$route.query.article_id};o.a.getUserInteractionWithArticle(e).then((function(e){var n=e.data;console.log(n),n.status&&(t.interaction=n.data)}))},type:function(t){return this.types[t]},goSquare:function(t){this.$router.push({name:"square",query:{tab:t}})}},watch:{$route:function(){this.$route.query.article_id&&this.getArticleDetail()}},mounted:function(){this.getArticleDetail(),this.getUserInteractionWithArticle()},components:{Comment:S,Empty:$.a,AvatarName:I}},T=n(308),j={insert:"head",singleton:!1},N=(x()(T.a,j),T.a.locals,Object(c.a)(E,i,[],!1,null,"1dafa516",null));N.options.__file="src/pages/user/components/articleDetail/ArticleDetail.vue";e.default=N.exports}}]);